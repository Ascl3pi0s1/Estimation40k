library(usethis)
library(usethis)
library(devtools)
library(tidyverse)
jet_de_touche=function(Nb_attack,CT,rrTouch=0,mod_Touch=0,Bless_auto=7){
x=sample(1:6,size=Nb_attack,replace = TRUE)
as=sum(x==1)
CT=min(6,max(CT-mod_Touch,2))
touch=sum(x>CT-1)
miss=sum(x<CT)
six=sum(x>=Bless_auto)
if(rrTouch==1){
x=sample(1:6,size=as,replace = TRUE)
touch=touch+sum(x>CT-1)
six=six+sum(x>=Bless_auto)
}
if(rrTouch==2){
x=sample(1:6,size=miss,replace = TRUE)
touch=touch+sum(x>CT-1)
six=six+sum(x>=Bless_auto)
}
as=sum(x==1)
miss=sum(x<CT)
#cat("Nombre de touche=",touch,"Nombre d'as=",as,"Nombre de blessure raté=",miss,"\n")
list(touch=touch,bless_auto=six)
}
x=jet_de_touche(20,3)
Bless_rate=function(x,y){
if(x>=2*y){a=2}
if(2*y>x & x>y){a=3}
if(x==y){a=4}
if(x<y & y<2){a=5}
if(y>=2*x){a=6}
a
}
jet_de_bless=function(JetTouch,For,End,rrBless=0,mod_Bless=0,Transu=0){
touche=JetTouch[[1]]
x=sample(1:6,size=touche,replace = TRUE)
B=max(min(6,max(Bless_rate(For,End)-mod_Bless,2)),Transu)
as=sum(x==1)
Bless=sum(x>B-1)
miss=sum(x<B)
if(rrBless==1){
x=sample(1:6,size=as,replace = TRUE)
Bless=Bless+sum(x>B-1)
}
if(rrBless==2){
x=sample(1:6,size=miss,replace = TRUE)
Bless=Bless+sum(x>B-1)
}
as=sum(x==1)
miss=sum(x<B)
#cat("Nombre de blessure=",Bless,"Nombre d'as=",as,"Nombre de blessure raté=",miss,"\n")
Bless+JetTouch[[2]]
}
jet_de_bless(x,4,4)
miss_save=function(bless,svg){rbinom(1,bless,(svg-1)/6)}
FNP=function(fnp,miss_save,dmg,Pv,save){
x=0
a=Pv
for (i in rep(dmg,miss_save)){
b=rbinom(1,dmg,(fnp-1)/6)
if((a-b)<=0){
x=x+1
a=Pv}
else{a=a-b}
}
#cat("Nombre de modèle tués=",x,"\n")
x
}
JetTot=function(Nb_attack,CT,rrTouch=0,mod_Touch=0,Bless_auto=7,For,End,rrBless=0,mod_Bless=0,Transu=0,dmg,Pv,svg,fnp=7){
FNP(fnp,miss_save(jet_de_bless(JetTouch = jet_de_touche(Nb_attack =  Nb_attack,CT = CT,rrTouch =  rrTouch,mod_Touch =  mod_Touch,Bless_auto =Bless_auto),For =  For,End = End,rrBless=rrBless,mod_Bless = mod_Bless, Transu = Transu),svg),dmg,Pv,save)
}
JetTot(Nb_attack = 20,CT = 3,rrTouch = 1,For = 4,End = 4,rrBless = 0,dmg = 1, Pv = 1, svg = 3)
x=replicate(10000,JetTot(Nb_attack = 8,CT = 3,rrTouch = 2,mod_Touch=0,Bless_auto=6,For = 8,End = 5,rrBless = 2,mod_Bless=1,Transu = 4,dmg = 3, Pv = 3, svg = 5,fnp=5))
X=data.frame(x)
colnames(X)=c("x1")
ggplot(data=X,aes(x=x1,y=stat(prop)))+geom_bar()
library(usethis)
library(devtools)
library(tidyverse)
jet_de_touche=function(Nb_attack,CT,rrTouch=0,mod_Touch=0,Bless_auto=7){
x=sample(1:6,size=Nb_attack,replace = TRUE)
as=sum(x==1)
CT=min(6,max(CT-mod_Touch,2))
touch=sum(x>CT-1)
miss=sum(x<CT)
six=sum(x>=Bless_auto)
if(rrTouch==1){
x=sample(1:6,size=as,replace = TRUE)
touch=touch+sum(x>CT-1)
six=six+sum(x>=Bless_auto)
}
if(rrTouch==2){
x=sample(1:6,size=miss,replace = TRUE)
touch=touch+sum(x>CT-1)
six=six+sum(x>=Bless_auto)
}
as=sum(x==1)
miss=sum(x<CT)
#cat("Nombre de touche=",touch,"Nombre d'as=",as,"Nombre de blessure raté=",miss,"\n")
list(touch=touch,bless_auto=six)
}
Bless_rate=function(x,y){
if(x>=2*y){a=2}
if(2*y>x & x>y){a=3}
if(x==y){a=4}
if(x<y & y<2){a=5}
if(y>=2*x){a=6}
a
}
jet_de_bless=function(JetTouch,For,End,rrBless=0,mod_Bless=0,Transu=0){
touche=JetTouch[[1]]
x=sample(1:6,size=touche,replace = TRUE)
B=max(min(6,max(Bless_rate(For,End)-mod_Bless,2)),Transu)
as=sum(x==1)
Bless=sum(x>B-1)
miss=sum(x<B)
if(rrBless==1){
x=sample(1:6,size=as,replace = TRUE)
Bless=Bless+sum(x>B-1)
}
if(rrBless==2){
x=sample(1:6,size=miss,replace = TRUE)
Bless=Bless+sum(x>B-1)
}
as=sum(x==1)
miss=sum(x<B)
#cat("Nombre de blessure=",Bless,"Nombre d'as=",as,"Nombre de blessure raté=",miss,"\n")
Bless+JetTouch[[2]]
}
miss_save=function(bless,svg){rbinom(1,bless,(svg-1)/6)}
FNP=function(fnp,miss_save,dmg,Pv,save){
x=0
a=Pv
for (i in rep(dmg,miss_save)){
b=rbinom(1,dmg,(fnp-1)/6)
if((a-b)<=0){
x=x+1
a=Pv}
else{a=a-b}
}
#cat("Nombre de modèle tués=",x,"\n")
x
}
JetTot=function(Nb_attack,CT,rrTouch=0,mod_Touch=0,Bless_auto=7,For,End,rrBless=0,mod_Bless=0,Transu=0,dmg,Pv,svg,fnp=7){
FNP(fnp,miss_save(jet_de_bless(JetTouch = jet_de_touche(Nb_attack =  Nb_attack,CT = CT,rrTouch =  rrTouch,mod_Touch =  mod_Touch,Bless_auto =Bless_auto),For =  For,End = End,rrBless=rrBless,mod_Bless = mod_Bless, Transu = Transu),svg),dmg,Pv,save)
}
package.skeleton(name="Estimation40k")
